{% extends "base.html" %}
{% load i18n %}
{% load static %}
{% block head %}
{# https://www.srihash.org/ #}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
  integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
  crossorigin="anonymous" />
<script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
  integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
  crossorigin="anonymous"></script>
{% endblock %}
{% block title %}Objector + Dashboard{% endblock %}
{% block content %}
<section aria-labelledby="applicant-information-title">
  <div class="bg-white shadow sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h2 id="applicant-information-title" class="text-lg leading-6 font-medium text-gray-900">
        {% translate "Dashboard" %}
      </h2>
    </div>
    <div id="mapid" style="width: 100%; height: 512px;"></div>
    <script>
      var greenIcon = L.icon({
        iconUrl: '{% static 'dashboardapp/img/marker-icon-green.png' %}',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [0, -34]
      });
      var amberIcon = L.icon({
        iconUrl: '{% static 'dashboardapp/img/marker-icon-amber.png' %}',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [0, -34]
      });
      var redIcon = L.icon({
        iconUrl: '{% static 'dashboardapp/img/marker-icon-red.png' %}',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [0, -34]
      });
      var mymap = L.map('mapid').setView([47.36667, 8.55], 9);

      L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
          'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>, ',
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1
      }).addTo(mymap);
      {% if locations %}
      {% for location in locations %}
      var marker{{ location.id }} = L.marker([{{ location.latitude }}, {{ location.longitude }}], { icon: {{ location.status_color }}Icon }).bindPopup("<a href='{% url 'inventory:location-detail' location.id %}'>{{ location.name }}</a>").addTo(mymap);
      {% endfor %}
      {% endif %}

    </script>
  </div>
</section>
{% endblock %}
